spring:
  application:
    name: zhitoujianli-backend
  # PostgreSQLæ•°æ®åº“é…ç½®ï¼ˆç”Ÿäº§ç‰ˆæœ¬ï¼‰
  datasource:
    url: ${DATABASE_URL:jdbc:postgresql://localhost:5432/zhitoujianli}
    driverClassName: org.postgresql.Driver
    username: ${DB_USERNAME:zhitoujianli}
    password: ${DB_PASSWORD:zhitoujianli123}
    # HikariCPè¿æ¥æ± é…ç½®ï¼ˆæ€§èƒ½æœ€ä¼˜ï¼‰
    hikari:
      # è¿æ¥æ± ä¸­å…è®¸çš„æœ€å°è¿æ¥æ•°
      minimum-idle: 5
      # è¿æ¥æ± ä¸­å…è®¸çš„æœ€å¤§è¿æ¥æ•°
      maximum-pool-size: 20
      # è¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
      connection-timeout: 30000
      # æœ€å¤§ç”Ÿå‘½å‘¨æœŸï¼ˆæ¯«ç§’ï¼Œ30åˆ†é’Ÿï¼‰
      max-lifetime: 1800000
      # ç©ºé—²è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼Œ10åˆ†é’Ÿï¼‰
      idle-timeout: 600000
      # è¿æ¥æµ‹è¯•æŸ¥è¯¢
      connection-test-query: SELECT 1
      # è¿æ¥æ± åç§°
      pool-name: ZhiTouJianLi-HikariCP
      # æ˜¯å¦è‡ªåŠ¨æäº¤
      auto-commit: true
      # è¿æ¥æ³„æ¼æ£€æµ‹é˜ˆå€¼ï¼ˆæ¯«ç§’ï¼Œ0è¡¨ç¤ºç¦ç”¨ï¼‰
      leak-detection-threshold: 60000
  jpa:
    database-platform: org.hibernate.dialect.PostgreSQLDialect
    hibernate:
      ddl-auto: validate # ğŸ”’ ç”Ÿäº§ç¯å¢ƒç¦æ­¢è‡ªåŠ¨ä¿®æ”¹è¡¨ç»“æ„
    show-sql: false
    properties:
      hibernate:
        format_sql: true
        # ç¼“å­˜é…ç½®
        cache:
          use_second_level_cache: false
          use_query_cache: false
        # æ‰¹å¤„ç†å¤§å°
        jdbc:
          batch_size: 20

# å®‰å…¨è®¤è¯å¼€å…³
# false: ç¦ç”¨è®¤è¯ï¼ˆæµ‹è¯•ç”¨ï¼‰
# true: å¯ç”¨è®¤è¯ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
security:
  enabled: ${SECURITY_ENABLED:true}

# JWTé…ç½®
jwt:
  secret: ${JWT_SECRET}
  expiration: ${JWT_EXPIRATION:86400000}

# å¾®ä¿¡æ”¯ä»˜é…ç½®ï¼ˆå¯é€‰ï¼‰
wechat:
  pay:
    merchantId: ${WECHAT_PAY_MERCHANT_ID:}
    apiKey: ${WECHAT_PAY_API_KEY:}
    certPath: ${WECHAT_PAY_CERT_PATH:src/main/resources/apiclient_cert.p12}
    notifyUrl: ${WECHAT_PAY_NOTIFY_URL:https://yourdomain.com/api/payment/wechat/notify}

# æ”¯ä»˜å®é…ç½®ï¼ˆå¯é€‰ï¼‰
alipay:
  appId: ${ALIPAY_APP_ID:}
  privateKey: ${ALIPAY_PRIVATE_KEY:}
  publicKey: ${ALIPAY_PUBLIC_KEY:}
  notifyUrl: ${ALIPAY_NOTIFY_URL:https://yourdomain.com/api/payment/alipay/notify}

# æœåŠ¡å™¨é…ç½®
server:
  port: ${SERVER_PORT:8080}
  # æ–‡ä»¶ä¸Šä¼ é…ç½®
  servlet:
    multipart:
      max-file-size: 10MB
      max-request-size: 10MB
      file-size-threshold: 2KB

# æ—¥å¿—é…ç½®
logging:
  level:
    root: INFO
    controller: DEBUG
    security: DEBUG
    config: DEBUG
    com.zaxxer.hikari: DEBUG
    org.hibernate.SQL: DEBUG
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE
  pattern:
    console: '%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n'
  file:
    name: logs/zhitoujianli.log
    max-size: 100MB
    max-history: 30

# Spring Boot Actuatorç›‘æ§é…ç½®
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus,hikaricp
  endpoint:
    health:
      show-details: always
  metrics:
    enable:
      hikaricp: true
    export:
      prometheus:
        enabled: true
