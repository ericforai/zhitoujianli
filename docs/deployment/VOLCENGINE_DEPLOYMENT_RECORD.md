# æ™ºæŠ•ç®€å†ç«å±±äº‘æœåŠ¡å™¨éƒ¨ç½²è®°å½•

## ğŸ“‹ éƒ¨ç½²ä¿¡æ¯

| é¡¹ç›® | è¯¦æƒ… |
|------|------|
| **éƒ¨ç½²æ—¥æœŸ** | 2025å¹´10æœˆ2æ—¥ |
| **æœåŠ¡å™¨æä¾›å•†** | ç«å±±äº‘ |
| **æœåŠ¡å™¨IP** | 115.190.182.95 |
| **æ“ä½œç³»ç»Ÿ** | CentOS/RHEL 8+ |
| **åŸŸå** | api.zhitoujianli.com |
| **éƒ¨ç½²æ–¹å¼** | è‡ªåŠ¨åŒ–è„šæœ¬éƒ¨ç½² |

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### ç³»ç»Ÿæ¶æ„å›¾
```
ç”¨æˆ·è¯·æ±‚
    â†“
EdgeOne CDN (zhitoujianli.com)
    â†“ å‰ç«¯é™æ€èµ„æº
    â†“ APIè¯·æ±‚ (/api/*)
ç«å±±äº‘æœåŠ¡å™¨ (115.190.182.95)
    â†“ Nginxåå‘ä»£ç† (80/443 â†’ 8080)
    â†“ Spring Bootåº”ç”¨ (ç«¯å£8080)
    â†“ MySQLæ•°æ®åº“ (ç«¯å£3306)
    â†“ Redisç¼“å­˜ (ç«¯å£6379)
```

### æŠ€æœ¯æ ˆ
- **å‰ç«¯**: React + TypeScript (EdgeOne CDN)
- **åç«¯**: Spring Boot + Java 17
- **æ•°æ®åº“**: MySQL 8.0
- **ç¼“å­˜**: Redis
- **WebæœåŠ¡å™¨**: Nginx
- **SSLè¯ä¹¦**: Let's Encrypt
- **æœåŠ¡ç®¡ç†**: systemd

## ğŸ› ï¸ éƒ¨ç½²è§„èŒƒ

### ç›®å½•ç»“æ„
```
/opt/zhitoujianli/
â”œâ”€â”€ app/                    # åº”ç”¨JARæ–‡ä»¶
â”‚   â””â”€â”€ get_jobs-2.0.1.jar
â”œâ”€â”€ config/                 # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ .env                # ç¯å¢ƒå˜é‡é…ç½®
â”œâ”€â”€ logs/                   # æ—¥å¿—æ–‡ä»¶
â”‚   â””â”€â”€ application.log
â”œâ”€â”€ backups/                # å¤‡ä»½æ–‡ä»¶
â””â”€â”€ check_status.sh         # çŠ¶æ€æ£€æŸ¥è„šæœ¬
```

### æœåŠ¡é…ç½®
- **åº”ç”¨æœåŠ¡**: zhitoujianli.service
- **ç«¯å£æ˜ å°„**: 8080 (å†…éƒ¨) â†’ 443 (å¤–éƒ¨HTTPS)
- **ç”¨æˆ·æƒé™**: zhitoujianli (érootç”¨æˆ·)
- **æ–‡ä»¶æƒé™**: é…ç½®æ–‡ä»¶600ï¼Œåº”ç”¨ç›®å½•755

### ç½‘ç»œé…ç½®
- **é˜²ç«å¢™ç«¯å£**: 22 (SSH), 80 (HTTP), 443 (HTTPS), 8080 (åº”ç”¨)
- **SSL/TLS**: TLS 1.2+, å¼ºå¯†ç å¥—ä»¶
- **CORSé…ç½®**: æ”¯æŒzhitoujianli.comåŸŸå

## ğŸš€ è‡ªåŠ¨éƒ¨ç½²æµç¨‹

### éƒ¨ç½²è„šæœ¬æ‰§è¡Œ
```bash
cd /Users/user/autoresume
./scripts/auto-deploy-volcengine.sh
```

### éƒ¨ç½²æ­¥éª¤è¯¦è§£

#### 1. æœåŠ¡å™¨è¿æ¥æµ‹è¯•
- éªŒè¯SSHè¿æ¥åˆ°115.190.182.95
- ç¡®è®¤rootç”¨æˆ·è®¿é—®æƒé™

#### 2. ç³»ç»Ÿç¯å¢ƒé…ç½®
- ç³»ç»ŸåŒ…æ›´æ–° (`yum update -y`)
- åŸºç¡€è½¯ä»¶å®‰è£… (wget, curl, vim, git)
- é˜²ç«å¢™é…ç½® (firewalld)

#### 3. åº”ç”¨ç”¨æˆ·åˆ›å»º
- åˆ›å»ºzhitoujianliç”¨æˆ·
- é…ç½®sudoæƒé™
- åˆ›å»ºåº”ç”¨ç›®å½•ç»“æ„

#### 4. è¿è¡Œç¯å¢ƒå®‰è£…
- **Java 17**: OpenJDKå®‰è£…å’Œé…ç½®
- **MySQL 8.0**: æ•°æ®åº“æœåŠ¡å®‰è£…
- **Redis**: ç¼“å­˜æœåŠ¡å®‰è£…
- **Nginx**: åå‘ä»£ç†æœåŠ¡å®‰è£…

#### 5. æ•°æ®åº“åˆå§‹åŒ–
```sql
CREATE DATABASE zhitoujianli DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE USER 'zhitoujianli'@'localhost' IDENTIFIED BY 'ZhiTou2025!@#';
GRANT ALL PRIVILEGES ON zhitoujianli.* TO 'zhitoujianli'@'localhost';
FLUSH PRIVILEGES;
```

#### 6. åº”ç”¨é…ç½®
- ç¯å¢ƒå˜é‡é…ç½® (.envæ–‡ä»¶)
- systemdæœåŠ¡é…ç½®
- æ—¥å¿—å’Œå¤‡ä»½ç­–ç•¥

#### 7. æœ¬åœ°åº”ç”¨æ„å»º
- ç®€åŒ–SecurityConfigé¿å…ç¼–è¯‘é”™è¯¯
- Mavenæ‰“åŒ… (`mvn clean package -DskipTests`)
- JARæ–‡ä»¶ç”Ÿæˆ

#### 8. åº”ç”¨éƒ¨ç½²
- JARæ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨
- æœåŠ¡å¯åŠ¨å’Œè‡ªå¯åŠ¨é…ç½®
- çŠ¶æ€éªŒè¯

#### 9. SSLè¯ä¹¦é…ç½®
- Let's Encryptè¯ä¹¦ç”³è¯·
- Nginx HTTPSé…ç½®
- è¯ä¹¦è‡ªåŠ¨ç»­æœŸè®¾ç½®

#### 10. éƒ¨ç½²éªŒè¯
- æœåŠ¡çŠ¶æ€æ£€æŸ¥
- ç«¯å£ç›‘å¬éªŒè¯
- APIå¥åº·æ£€æŸ¥
- èµ„æºä½¿ç”¨ç‡ç›‘æ§

## ğŸ“Š ç›‘æ§å’Œç»´æŠ¤

### çŠ¶æ€æ£€æŸ¥å‘½ä»¤
```bash
# æœåŠ¡çŠ¶æ€æ£€æŸ¥
ssh root@115.190.182.95 '/opt/zhitoujianli/check_status.sh'

# å®æ—¶æ—¥å¿—æŸ¥çœ‹
ssh root@115.190.182.95 'journalctl -u zhitoujianli -f'

# ç³»ç»Ÿèµ„æºç›‘æ§
ssh root@115.190.182.95 'top'
ssh root@115.190.182.95 'df -h'
ssh root@115.190.182.95 'free -h'
```

### é‡è¦æ–‡ä»¶ä½ç½®
| æ–‡ä»¶ç±»å‹ | è·¯å¾„ |
|---------|------|
| åº”ç”¨é…ç½® | `/opt/zhitoujianli/config/.env` |
| åº”ç”¨æ—¥å¿— | `/opt/zhitoujianli/logs/application.log` |
| ç³»ç»Ÿæ—¥å¿— | `journalctl -u zhitoujianli` |
| Nginxé…ç½® | `/etc/nginx/conf.d/zhitoujianli.conf` |
| SSLè¯ä¹¦ | `/etc/letsencrypt/live/api.zhitoujianli.com/` |
| æœåŠ¡é…ç½® | `/etc/systemd/system/zhitoujianli.service` |

### å¤‡ä»½ç­–ç•¥
- **é¢‘ç‡**: æ¯æ—¥å‡Œæ™¨2ç‚¹è‡ªåŠ¨å¤‡ä»½
- **å†…å®¹**: æ•°æ®åº“ã€åº”ç”¨é…ç½®ã€JARæ–‡ä»¶
- **ä¿ç•™æœŸ**: 30å¤©è‡ªåŠ¨æ¸…ç†
- **ä½ç½®**: `/opt/zhitoujianli/backups/`

## ğŸŒ åŸŸåå’Œç½‘ç»œé…ç½®

### DNSé…ç½®è¦æ±‚
åœ¨åŸŸåç®¡ç†é¢æ¿æ·»åŠ ä»¥ä¸‹è®°å½•ï¼š
```
ç±»å‹: A
ä¸»æœºè®°å½•: api
è§£æå€¼: 115.190.182.95
TTL: 600ç§’
```

### EdgeOneç¯å¢ƒå˜é‡æ›´æ–°
åœ¨è…¾è®¯äº‘EdgeOneæ§åˆ¶å°æ›´æ–°ï¼š
```json
{
  "env": {
    "REACT_APP_API_URL": "https://api.zhitoujianli.com/api"
  }
}
```

## ğŸ”’ å®‰å…¨é…ç½®

### è®¿é—®æ§åˆ¶
- SSHå¯†é’¥è®¤è¯
- é˜²ç«å¢™ç«¯å£é™åˆ¶
- åº”ç”¨ç”¨æˆ·æƒé™éš”ç¦»
- æ•°æ®åº“ç”¨æˆ·æƒé™æœ€å°åŒ–

### SSL/TLSé…ç½®
- TLS 1.2+ åè®®
- å¼ºå¯†ç å¥—ä»¶
- HSTSå®‰å…¨å¤´
- è¯ä¹¦è‡ªåŠ¨ç»­æœŸ

### æ•°æ®ä¿æŠ¤
- æ•°æ®åº“å¯†ç å¼ºåº¦è¦æ±‚
- é…ç½®æ–‡ä»¶æƒé™æ§åˆ¶
- å®šæœŸå¤‡ä»½ç­–ç•¥
- æ—¥å¿—å®‰å…¨å­˜å‚¨

## ğŸš¨ æ•…éšœå¤„ç†

### å¸¸è§é—®é¢˜è¯Šæ–­

#### 1. åº”ç”¨å¯åŠ¨å¤±è´¥
```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
systemctl status zhitoujianli

# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
journalctl -u zhitoujianli --since "10 minutes ago"

# æ£€æŸ¥é…ç½®æ–‡ä»¶
cat /opt/zhitoujianli/config/.env
```

#### 2. æ•°æ®åº“è¿æ¥é—®é¢˜
```bash
# æµ‹è¯•æ•°æ®åº“è¿æ¥
mysql -u zhitoujianli -p zhitoujianli

# æ£€æŸ¥MySQLæœåŠ¡
systemctl status mysqld

# æŸ¥çœ‹MySQLé”™è¯¯æ—¥å¿—
tail -f /var/log/mysqld.log
```

#### 3. SSLè¯ä¹¦é—®é¢˜
```bash
# æ£€æŸ¥è¯ä¹¦çŠ¶æ€
certbot certificates

# æ‰‹åŠ¨ç»­æœŸ
certbot renew

# æµ‹è¯•Nginxé…ç½®
nginx -t
```

#### 4. ç½‘ç»œè¿é€šæ€§é—®é¢˜
```bash
# æ£€æŸ¥ç«¯å£ç›‘å¬
netstat -tlnp | grep -E "(80|443|8080)"

# æµ‹è¯•å†…éƒ¨API
curl http://localhost:8080/health

# æµ‹è¯•å¤–éƒ¨è®¿é—®
curl https://api.zhitoujianli.com/health
```

### åº”æ€¥æ¢å¤æ­¥éª¤

1. **æœåŠ¡é‡å¯**
   ```bash
   systemctl restart zhitoujianli
   systemctl restart nginx
   systemctl restart mysqld
   ```

2. **é…ç½®æ¢å¤**
   ```bash
   # ä»å¤‡ä»½æ¢å¤é…ç½®
   cp /opt/zhitoujianli/backups/config_æœ€æ–°æ—¥æœŸ/* /opt/zhitoujianli/config/
   ```

3. **æ•°æ®åº“æ¢å¤**
   ```bash
   # ä»å¤‡ä»½æ¢å¤æ•°æ®åº“
   mysql -u zhitoujianli -p zhitoujianli < /opt/zhitoujianli/backups/db_æœ€æ–°æ—¥æœŸ.sql
   ```

## ğŸ“ æŠ€æœ¯æ”¯æŒä¿¡æ¯

### å…³é”®è”ç³»ä¿¡æ¯
- **æœåŠ¡å™¨IP**: 115.190.182.95
- **SSHç”¨æˆ·**: root
- **æ•°æ®åº“å¯†ç **: ZhiTou2025!@#
- **åº”ç”¨ç«¯å£**: 8080
- **ç®¡ç†åŸŸå**: api.zhitoujianli.com

### ç»´æŠ¤çª—å£
- **å®šæœŸç»´æŠ¤**: æ¯å‘¨æ—¥å‡Œæ™¨2-4ç‚¹
- **å®‰å…¨æ›´æ–°**: æ¯æœˆç¬¬ä¸€ä¸ªå‘¨æœ«
- **å¤‡ä»½æ£€æŸ¥**: æ¯æœˆ15æ—¥

### æ–‡æ¡£ç‰ˆæœ¬
- **åˆ›å»ºæ—¥æœŸ**: 2025å¹´10æœˆ2æ—¥
- **æœ€åæ›´æ–°**: 2025å¹´10æœˆ2æ—¥
- **ç‰ˆæœ¬å·**: v1.0
- **è´£ä»»äºº**: æ™ºæŠ•ç®€å†æŠ€æœ¯å›¢é˜Ÿ

---

**é‡è¦æé†’**: 
- ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å‰åŠ¡å¿…å¤‡ä»½é‡è¦æ•°æ®
- å®šæœŸæ£€æŸ¥SSLè¯ä¹¦æœ‰æ•ˆæœŸ
- ç›‘æ§ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ
- ä¿æŒç³»ç»Ÿå’Œåº”ç”¨æ›´æ–°