# æ™ºæŠ•ç®€å† - ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£å®šä¹‰äº†ç”Ÿäº§ç¯å¢ƒçš„éƒ¨ç½²æµç¨‹ï¼Œç¡®ä¿ç³»ç»Ÿç¨³å®šè¿è¡Œï¼Œé¿å…é¢‘ç¹æ”¹åŠ¨ç”Ÿäº§ç³»ç»Ÿã€‚

**æ ¸å¿ƒåŸåˆ™**ï¼š
- âœ… ç‰ˆæœ¬åŒ–ç®¡ç†ï¼šæ‰€æœ‰éƒ¨ç½²å¿…é¡»ä½¿ç”¨ç‰ˆæœ¬æ ‡ç­¾
- âœ… æµ‹è¯•å…ˆè¡Œï¼šå¿…é¡»å…ˆé€šè¿‡æµ‹è¯•ç¯å¢ƒéªŒè¯
- âœ… å¯å›æ»šï¼šæ¯æ¬¡éƒ¨ç½²å¿…é¡»æ”¯æŒå¿«é€Ÿå›æ»š
- âœ… æ–‡æ¡£è®°å½•ï¼šæ‰€æœ‰éƒ¨ç½²æ“ä½œå¿…é¡»è®°å½•

---

## ğŸ—ï¸ éƒ¨ç½²æ¶æ„

### ç¯å¢ƒåˆ’åˆ†

```
å¼€å‘ç¯å¢ƒ (dev)
    â†“
æµ‹è¯•ç¯å¢ƒ (test)
    â†“
é¢„å‘å¸ƒç¯å¢ƒ (staging)
    â†“
ç”Ÿäº§ç¯å¢ƒ (production)
```

### ç‰ˆæœ¬ç®¡ç†

**ç‰ˆæœ¬å·æ ¼å¼**ï¼š`v{major}.{minor}.{patch}`

- `major`: é‡å¤§åŠŸèƒ½å˜æ›´æˆ–æ¶æ„è°ƒæ•´
- `minor`: æ–°åŠŸèƒ½æ·»åŠ 
- `patch`: Bugä¿®å¤æˆ–å°ä¼˜åŒ–

**ç¤ºä¾‹**ï¼š
- `v2.1.0` - å¤šç§Ÿæˆ·Bossç™»å½•åŠŸèƒ½
- `v2.1.1` - ä¿®å¤Cookieéš”ç¦»é—®é¢˜
- `v3.0.0` - å‰ç«¯é‡æ„

---

## ğŸ“¦ éƒ¨ç½²æµç¨‹

### 1. å¼€å‘é˜¶æ®µ

#### 1.1 ä»£ç å¼€å‘
```bash
# åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
git checkout -b feat/feature-name

# å¼€å‘ä»£ç 
# ... ç¼–å†™ä»£ç  ...

# æäº¤ä»£ç 
git add .
git commit -m "feat(feature): æ·»åŠ æ–°åŠŸèƒ½"
```

#### 1.2 æœ¬åœ°æµ‹è¯•
```bash
# åç«¯æµ‹è¯•
cd backend/get_jobs
mvn test

# å‰ç«¯æµ‹è¯•
cd frontend
npm test

# ä»£ç è´¨é‡æ£€æŸ¥
npm run lint
npm run type-check
```

### 2. æµ‹è¯•ç¯å¢ƒéƒ¨ç½²

#### 2.1 åˆ›å»ºæµ‹è¯•åˆ†æ”¯
```bash
git checkout -b test/feature-name
git push origin test/feature-name
```

#### 2.2 éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒ
```bash
# åç«¯éƒ¨ç½²
cd backend/get_jobs
mvn clean package -DskipTests
# éƒ¨ç½²åˆ°æµ‹è¯•æœåŠ¡å™¨...

# å‰ç«¯éƒ¨ç½²
cd frontend
npm run build
# éƒ¨ç½²åˆ°æµ‹è¯•æœåŠ¡å™¨...
```

#### 2.3 æµ‹è¯•éªŒè¯
- [ ] åŠŸèƒ½æµ‹è¯•
- [ ] å¤šç§Ÿæˆ·éš”ç¦»æµ‹è¯•
- [ ] æ€§èƒ½æµ‹è¯•
- [ ] å®‰å…¨æµ‹è¯•

### 3. é¢„å‘å¸ƒç¯å¢ƒéªŒè¯

#### 3.1 åˆå¹¶åˆ°ä¸»åˆ†æ”¯
```bash
git checkout main
git merge test/feature-name
git push origin main
```

#### 3.2 åˆ›å»ºç‰ˆæœ¬æ ‡ç­¾
```bash
# åˆ›å»ºç‰ˆæœ¬æ ‡ç­¾
git tag -a v2.1.2 -m "ç‰ˆæœ¬ v2.1.2: ä¿®å¤å¤šç§Ÿæˆ·å®‰å…¨é—®é¢˜"
git push origin v2.1.2
```

#### 3.3 é¢„å‘å¸ƒéªŒè¯
```bash
# ä½¿ç”¨ç‰ˆæœ¬æ ‡ç­¾éƒ¨ç½²åˆ°é¢„å‘å¸ƒç¯å¢ƒ
./scripts/deploy-staging.sh v2.1.2
```

### 4. ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

#### 4.1 éƒ¨ç½²å‰æ£€æŸ¥æ¸…å•

**ä»£ç æ£€æŸ¥**ï¼š
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [ ] ä»£ç å®¡æŸ¥å®Œæˆ
- [ ] å¤šç§Ÿæˆ·éš”ç¦»éªŒè¯é€šè¿‡
- [ ] å®‰å…¨å®¡è®¡é€šè¿‡

**ç¯å¢ƒæ£€æŸ¥**ï¼š
- [ ] å¤‡ä»½æ•°æ®åº“
- [ ] å¤‡ä»½ç”¨æˆ·æ•°æ®ç›®å½•
- [ ] æ£€æŸ¥ç£ç›˜ç©ºé—´
- [ ] æ£€æŸ¥æœåŠ¡çŠ¶æ€

**æ–‡æ¡£æ£€æŸ¥**ï¼š
- [ ] æ›´æ–°CHANGELOG.md
- [ ] æ›´æ–°APIæ–‡æ¡£ï¼ˆå¦‚æœ‰å˜æ›´ï¼‰
- [ ] å‡†å¤‡å›æ»šæ–¹æ¡ˆ

#### 4.2 æ‰§è¡Œéƒ¨ç½²

**åç«¯éƒ¨ç½²**ï¼š
```bash
# 1. åˆ‡æ¢åˆ°é¡¹ç›®ç›®å½•
cd /root/zhitoujianli/backend/get_jobs

# 2. æ‹‰å–æœ€æ–°ä»£ç 
git fetch origin
git checkout v2.1.2  # ä½¿ç”¨ç‰ˆæœ¬æ ‡ç­¾

# 3. æ„å»ºJARåŒ…
mvn clean package -DskipTests

# 4. å¤‡ä»½å½“å‰ç‰ˆæœ¬
cp /opt/zhitoujianli/backend/get_jobs-latest.jar \
   /opt/zhitoujianli/backend/backup/get_jobs-v2.1.1.jar

# 5. éƒ¨ç½²æ–°ç‰ˆæœ¬
cp target/get_jobs-*.jar /opt/zhitoujianli/backend/get_jobs-v2.1.2.jar
ln -sf /opt/zhitoujianli/backend/get_jobs-v2.1.2.jar \
       /opt/zhitoujianli/backend/get_jobs-latest.jar

# 6. é‡å¯æœåŠ¡
systemctl restart zhitoujianli-backend.service

# 7. éªŒè¯æœåŠ¡
systemctl status zhitoujianli-backend.service
journalctl -u zhitoujianli-backend.service -n 50
```

**å‰ç«¯éƒ¨ç½²**ï¼š
```bash
# 1. åˆ‡æ¢åˆ°é¡¹ç›®ç›®å½•
cd /root/zhitoujianli/frontend

# 2. æ‹‰å–æœ€æ–°ä»£ç 
git fetch origin
git checkout v2.1.2  # ä½¿ç”¨ç‰ˆæœ¬æ ‡ç­¾

# 3. æ„å»ºå‰ç«¯
npm run build

# 4. éƒ¨ç½²ï¼ˆä½¿ç”¨è‡ªåŠ¨åŒ–è„šæœ¬ï¼‰
cd /root/zhitoujianli
./deploy-frontend.sh
```

#### 4.3 éƒ¨ç½²åéªŒè¯

**åŠŸèƒ½éªŒè¯**ï¼š
```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
curl http://localhost:8080/api/status

# æ£€æŸ¥å‰ç«¯
curl -I https://zhitoujianli.com

# æ£€æŸ¥å¤šç§Ÿæˆ·éš”ç¦»
# ä½¿ç”¨ä¸¤ä¸ªä¸åŒç”¨æˆ·è´¦å·ç™»å½•ï¼ŒéªŒè¯æ•°æ®éš”ç¦»
```

**ç›‘æ§æ£€æŸ¥**ï¼š
- [ ] æœåŠ¡æ—¥å¿—æ— é”™è¯¯
- [ ] ç³»ç»Ÿèµ„æºä½¿ç”¨æ­£å¸¸
- [ ] APIå“åº”æ—¶é—´æ­£å¸¸
- [ ] ç”¨æˆ·åé¦ˆæ­£å¸¸

---

## ğŸ”„ å›æ»šæµç¨‹

### å¿«é€Ÿå›æ»šï¼ˆ5åˆ†é’Ÿå†…ï¼‰

**åç«¯å›æ»š**ï¼š
```bash
# 1. åœæ­¢æœåŠ¡
systemctl stop zhitoujianli-backend.service

# 2. æ¢å¤ä¸Šä¸€ç‰ˆæœ¬
ln -sf /opt/zhitoujianli/backend/get_jobs-v2.1.1.jar \
       /opt/zhitoujianli/backend/get_jobs-latest.jar

# 3. é‡å¯æœåŠ¡
systemctl start zhitoujianli-backend.service

# 4. éªŒè¯
systemctl status zhitoujianli-backend.service
```

**å‰ç«¯å›æ»š**ï¼š
```bash
# 1. åˆ‡æ¢åˆ°ä¸Šä¸€ç‰ˆæœ¬
cd /root/zhitoujianli/frontend
git checkout v2.1.1

# 2. é‡æ–°æ„å»ºå’Œéƒ¨ç½²
npm run build
cd /root/zhitoujianli
./deploy-frontend.sh
```

### å®Œæ•´å›æ»šï¼ˆåŒ…å«æ•°æ®åº“ï¼‰

å¦‚æœéƒ¨ç½²æ¶‰åŠæ•°æ®åº“å˜æ›´ï¼Œéœ€è¦æ‰§è¡Œæ•°æ®åº“å›æ»šï¼š

```bash
# 1. æ¢å¤æ•°æ®åº“å¤‡ä»½
pg_restore -d zhitoujianli /opt/zhitoujianli/backup/db_backup_20251106.dump

# 2. æ¢å¤ç”¨æˆ·æ•°æ®ç›®å½•
cp -r /opt/zhitoujianli/backup/user_data_20251106/* \
      /opt/zhitoujianli/backend/user_data/

# 3. æ‰§è¡Œä»£ç å›æ»šï¼ˆåŒä¸Šï¼‰
```

---

## ğŸ“ éƒ¨ç½²è®°å½•æ¨¡æ¿

æ¯æ¬¡éƒ¨ç½²å¿…é¡»è®°å½•ä»¥ä¸‹ä¿¡æ¯ï¼š

```markdown
## éƒ¨ç½²è®°å½• - v2.1.2

**éƒ¨ç½²æ—¶é—´**: 2025-11-07 14:00
**éƒ¨ç½²äººå‘˜**: [å§“å]
**éƒ¨ç½²ç±»å‹**: [åŠŸèƒ½æ›´æ–°/Bugä¿®å¤/å®‰å…¨è¡¥ä¸]

### å˜æ›´å†…å®¹
- ä¿®å¤å¤šç§Ÿæˆ·æ•°æ®éš”ç¦»é—®é¢˜
- ä¼˜åŒ–Bossç™»å½•æµç¨‹

### éƒ¨ç½²æ­¥éª¤
1. åˆ›å»ºç‰ˆæœ¬æ ‡ç­¾ v2.1.2
2. éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒéªŒè¯
3. éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
4. éªŒè¯åŠŸèƒ½æ­£å¸¸

### å›æ»šæ–¹æ¡ˆ
- å¿«é€Ÿå›æ»šï¼šæ¢å¤ v2.1.1
- æ•°æ®åº“å›æ»šï¼šä½¿ç”¨å¤‡ä»½ 20251106

### éªŒè¯ç»“æœ
- âœ… æœåŠ¡å¯åŠ¨æ­£å¸¸
- âœ… å¤šç§Ÿæˆ·éš”ç¦»éªŒè¯é€šè¿‡
- âœ… ç”¨æˆ·åé¦ˆæ­£å¸¸

### é—®é¢˜è®°å½•
æ— 
```

---

## ğŸš¨ ç´§æ€¥æƒ…å†µå¤„ç†

### ç”Ÿäº§ç¯å¢ƒæ•…éšœ

**ç«‹å³æ‰§è¡Œ**ï¼š
1. åœæ­¢æ–°ç‰ˆæœ¬éƒ¨ç½²
2. æ‰§è¡Œå¿«é€Ÿå›æ»š
3. é€šçŸ¥ç›¸å…³äººå‘˜
4. è®°å½•æ•…éšœè¯¦æƒ…

**æ•…éšœæŠ¥å‘Šæ¨¡æ¿**ï¼š
```markdown
## æ•…éšœæŠ¥å‘Š

**æ—¶é—´**: [æ—¶é—´]
**å½±å“èŒƒå›´**: [å½±å“ç”¨æˆ·æ•°/åŠŸèƒ½]
**æ•…éšœåŸå› **: [åˆæ­¥åˆ†æ]
**å¤„ç†æªæ–½**: [å·²æ‰§è¡Œçš„æ“ä½œ]
**åç»­è®¡åˆ’**: [ä¿®å¤è®¡åˆ’]
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [ä»£ç å®¡æŸ¥æ£€æŸ¥æ¸…å•](./CODE_REVIEW_CHECKLIST.md)
- [å¤šç§Ÿæˆ·å®‰å…¨éªŒè¯](./MULTI_TENANT_SECURITY.md)
- [éƒ¨ç½²è„šæœ¬è¯´æ˜](../scripts/README.md)

---

## âœ… éƒ¨ç½²æ£€æŸ¥æ¸…å•

### éƒ¨ç½²å‰
- [ ] ä»£ç å®¡æŸ¥å®Œæˆ
- [ ] æµ‹è¯•ç¯å¢ƒéªŒè¯é€šè¿‡
- [ ] ç‰ˆæœ¬æ ‡ç­¾å·²åˆ›å»º
- [ ] å¤‡ä»½å·²å®Œæˆ
- [ ] å›æ»šæ–¹æ¡ˆå·²å‡†å¤‡

### éƒ¨ç½²ä¸­
- [ ] ä½¿ç”¨ç‰ˆæœ¬æ ‡ç­¾éƒ¨ç½²
- [ ] è®°å½•éƒ¨ç½²æ­¥éª¤
- [ ] ç›‘æ§æœåŠ¡çŠ¶æ€

### éƒ¨ç½²å
- [ ] åŠŸèƒ½éªŒè¯é€šè¿‡
- [ ] æ€§èƒ½æµ‹è¯•é€šè¿‡
- [ ] å®‰å…¨éªŒè¯é€šè¿‡
- [ ] ç”¨æˆ·åé¦ˆæ­£å¸¸
- [ ] éƒ¨ç½²è®°å½•å·²æ›´æ–°

---

**æœ€åæ›´æ–°**: 2025-11-07
**ç»´æŠ¤äººå‘˜**: æ™ºæŠ•ç®€å†å›¢é˜Ÿ
