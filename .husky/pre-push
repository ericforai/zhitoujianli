#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# æ¨é€å‰çš„æ£€æŸ¥
echo "ğŸš€ æ¨é€å‰æ£€æŸ¥..."

# è¿è¡Œå®Œæ•´çš„æµ‹è¯•å¥—ä»¶
echo "ğŸ§ª è¿è¡Œæµ‹è¯•å¥—ä»¶..."

# å‰ç«¯æµ‹è¯•
if [ -d "frontend" ]; then
  echo "ğŸ“± è¿è¡Œå‰ç«¯æµ‹è¯•..."
  cd frontend
  npm test -- --watchAll=false --coverage --passWithNoTests
  cd ..
fi

# åç«¯æµ‹è¯•
if [ -d "backend/get_jobs" ]; then
  echo "âš™ï¸ è¿è¡Œåç«¯æµ‹è¯•..."
  cd backend/get_jobs
  mvn test
  cd ../..
fi

# æ„å»ºæ£€æŸ¥
echo "ğŸ—ï¸ æ„å»ºæ£€æŸ¥..."

# å‰ç«¯æ„å»º
if [ -d "frontend" ]; then
  echo "ğŸ“± æ„å»ºå‰ç«¯..."
  cd frontend
  npm run build
  cd ..
fi

# åç«¯æ„å»º
if [ -d "backend/get_jobs" ]; then
  echo "âš™ï¸ æ„å»ºåç«¯..."
  cd backend/get_jobs
  mvn compile
  cd ../..
fi

echo "âœ… æ¨é€å‰æ£€æŸ¥å®Œæˆï¼"
