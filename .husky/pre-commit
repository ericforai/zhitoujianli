#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸ” è¿è¡Œé¢„æäº¤æ£€æŸ¥ï¼ˆLintã€æ ¼å¼æ ¡éªŒã€åˆå¹¶å†²çªæ ‡è®°æ£€æµ‹ã€é—ç•™ç›®å½•æ£€æµ‹ï¼‰..."

# åˆå¹¶å†²çªæ ‡è®°æ£€æµ‹
if git diff --cached | grep -E '^(<<<<<<<|=======|>>>>>>>)( .*)?$' > /dev/null; then
  echo "âŒ æ£€æµ‹åˆ°åˆå¹¶å†²çªæ ‡è®°ï¼Œè¯·å…ˆè§£å†³å†²çªåå†æäº¤ã€‚"
  exit 1
fi

# é—ç•™ç›®å½•æ£€æµ‹ï¼ˆé˜»æ­¢æäº¤ï¼‰
bash ./scripts/check-legacy-sources.sh || exit 1

# å‰ç«¯ä»£ç è´¨é‡æ£€æŸ¥
cd frontend || exit 1

# æš‚æ—¶è·³è¿‡TypeScriptç±»å‹æ£€æŸ¥
# åŸå› ï¼šTypeScript 4.9.5 ä¸ react-hook-form 7.66.0 çš„ç±»å‹å®šä¹‰ä¸å…¼å®¹
# TODO: å‡çº§TypeScriptç‰ˆæœ¬åæ¢å¤ç±»å‹æ£€æŸ¥
# npm run type-check || exit 1

npm run lint:check || exit 1
npm run format:check || exit 1

echo "âœ… é¢„æäº¤æ£€æŸ¥é€šè¿‡"
