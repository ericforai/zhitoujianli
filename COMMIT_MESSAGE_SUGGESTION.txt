feat(version): 实施完整的后端版本管理系统

## 🎯 问题背景
- 14个不同格式的JAR版本混乱堆积（占用4.2GB）
- 无法追踪当前运行版本
- 手动构建和部署容易出错
- 没有自动化回滚机制

## ✅ 解决方案

### 1. 统一版本规范
- 采用语义化版本号（Semantic Versioning）
- JAR命名规范：get_jobs-v{VERSION}.jar
- Git信息通过git.properties在运行时暴露

### 2. Maven集成
- 添加Git Commit ID插件自动获取Git信息
- 自动生成git.properties文件
- 规范化构建输出

### 3. 版本追踪API
**新增控制器：**
- VersionController.java - 暴露版本API
- VersionInfo.java - 版本信息工具类

**API端点：**
- GET /api/version - 完整版本信息
- GET /api/version/short - 简化版本信息
- GET /api/version/health - 健康检查+版本

**返回信息：**
- 版本号、Git SHA、Git分支
- 构建时间、提交时间、提交消息
- 运行时长、Java版本、Spring版本
- 操作系统信息

### 4. 自动化工具链
**新增脚本：**
- build-backend.sh - 自动化构建
  * 读取pom.xml版本号
  * 获取Git提交信息
  * Maven构建并复制到部署目录

- deploy-backend.sh - 智能部署
  * 查找最新JAR
  * 自动备份当前版本
  * 更新符号链接
  * 重启服务
  * 健康检查（60秒超时）
  * 失败自动回滚

- cleanup-old-versions.sh - 清理旧版本
  * 保留最近N个版本（默认3个）
  * 清理备份目录
  * 显示释放的磁盘空间

- get-current-version.sh - 版本查询
  * 文件系统版本信息
  * 服务状态查询
  * API版本信息
  * 列出所有可用版本

### 5. 应用启动日志
- 应用启动时自动记录版本信息
- 显示：版本号、Git SHA、分支、构建时间、提交消息

### 6. Spring Security配置
- 版本API设为公开访问（/api/version/**）
- 无需认证即可查询版本信息

### 7. 完整文档
- VERSION_MANAGEMENT.md - 完整版本管理规范
- VERSION_QUICK_REFERENCE.md - 快速参考指南
- VERSION_SYSTEM_SUMMARY.md - 实施总结

## 📊 实施成果

**Before:**
- ❌ 14个版本混乱堆积（4.2GB）
- ❌ 无法追踪当前版本
- ❌ 手动构建和部署
- ❌ 没有回滚机制

**After:**
- ✅ 统一语义化版本规范
- ✅ 保留3个最新版本（自动清理）
- ✅ 实时版本追踪API
- ✅ 全自动化构建和部署
- ✅ 自动备份和回滚
- ✅ 节省64%磁盘空间

## 📁 修改文件列表

### 新增文件
**后端代码：**
- src/main/java/com/superxiang/controller/VersionController.java
- src/main/java/com/superxiang/utils/VersionInfo.java

**自动化脚本：**
- scripts/build-backend.sh
- scripts/deploy-backend.sh
- scripts/cleanup-old-versions.sh
- scripts/get-current-version.sh

**文档：**
- docs/backend/VERSION_MANAGEMENT.md
- docs/backend/VERSION_QUICK_REFERENCE.md
- docs/backend/VERSION_SYSTEM_SUMMARY.md

### 修改文件
**后端配置：**
- backend/get_jobs/pom.xml
  * 更新版本号为2.2.0
  * 添加Git Commit ID插件
  * 修改JAR命名规范
  * 修复测试配置

**应用代码：**
- src/main/java/com/superxiang/WebApplication.java
  * 启动时记录版本信息

**安全配置：**
- src/main/java/config/SimpleSecurityConfig.java
  * 版本API设为公开访问

## 🔧 使用方法

```bash
# 构建
./scripts/build-backend.sh

# 部署
./scripts/deploy-backend.sh

# 查询版本
./scripts/get-current-version.sh quick

# 清理旧版本
./scripts/cleanup-old-versions.sh 3

# API查询
curl http://localhost:8080/api/version
```

## 📝 版本号规则

- Bug修复：增加PATCH（2.2.0 → 2.2.1）
- 新功能：增加MINOR（2.2.1 → 2.3.0）
- 破坏性变更：增加MAJOR（2.3.0 → 3.0.0）

## 🎯 影响范围

- 后端构建和部署流程
- 版本追踪和监控
- 系统维护和故障排查

## ✅ 测试验证

- [x] Maven构建成功
- [x] JAR文件正确命名
- [x] git.properties正确生成
- [x] 版本API返回完整信息
- [x] 自动化部署成功
- [x] 健康检查通过
- [x] 版本查询脚本正常
- [x] 清理脚本正常
- [x] 应用启动日志显示版本信息

## 📚 相关文档

- docs/backend/VERSION_MANAGEMENT.md
- docs/backend/VERSION_QUICK_REFERENCE.md
- docs/backend/VERSION_SYSTEM_SUMMARY.md

---

**Breaking Changes:** 无
**Deprecations:** 无
**Migration Required:** 无

此次变更完全向后兼容，不影响现有功能。所有版本管理功能为新增功能。

---

**提交建议（Git Commit Message）：**

```bash
git add .
git commit -m "feat(version): 实施完整的后端版本管理系统

- 采用语义化版本规范（Semantic Versioning）
- 集成Git Commit ID插件自动获取Git信息
- 新增版本追踪API（/api/version）
- 新增4个自动化脚本（构建/部署/清理/查询）
- 智能部署支持自动备份和回滚
- 应用启动时记录版本信息
- 完整的文档和快速参考指南

解决问题：
- 版本混乱（14个版本堆积）
- 无法追踪当前运行版本
- 手动操作容易出错
- 没有回滚机制

成果：
- 节省64%磁盘空间（4.2GB → 1.5GB）
- 全自动化构建和部署
- 实时版本追踪
- 自动备份和回滚
"
```

---

**下一步建议：**

1. 设置cron定时清理旧版本
2. 集成到CI/CD流程
3. 添加版本监控告警
4. 实施前端版本管理

---

**创建时间：** 2025-11-03
**创建者：** Cursor AI + ZhiTouJianLi Team





