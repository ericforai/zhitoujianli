---
import { Icon } from 'astro-icon/components';

export interface Props {
  title?: string;
  message?: string;
  type?: 'error' | 'warning' | 'info';
  showRetry?: boolean;
  retryText?: string;
  class?: string;
}

const {
  title = '出现错误',
  message = '抱歉，页面加载时出现了问题。请稍后重试。',
  type = 'error',
  showRetry = true,
  retryText = '重试',
  class: className = ''
} = Astro.props;

const typeStyles = {
  error: {
    icon: 'tabler:alert-circle',
    iconColor: 'text-red-500',
    bgColor: 'bg-red-50 dark:bg-red-900/20',
    borderColor: 'border-red-200 dark:border-red-800',
    textColor: 'text-red-800 dark:text-red-200'
  },
  warning: {
    icon: 'tabler:alert-triangle',
    iconColor: 'text-yellow-500',
    bgColor: 'bg-yellow-50 dark:bg-yellow-900/20',
    borderColor: 'border-yellow-200 dark:border-yellow-800',
    textColor: 'text-yellow-800 dark:text-yellow-200'
  },
  info: {
    icon: 'tabler:info-circle',
    iconColor: 'text-blue-500',
    bgColor: 'bg-blue-50 dark:bg-blue-900/20',
    borderColor: 'border-blue-200 dark:border-blue-800',
    textColor: 'text-blue-800 dark:text-blue-200'
  }
};

const style = typeStyles[type];
---

<div class={`p-4 rounded-lg border ${style.bgColor} ${style.borderColor} ${className}`}>
  <div class="flex items-start">
    <div class="flex-shrink-0">
      <Icon
        name={style.icon}
        class={`w-5 h-5 ${style.iconColor}`}
        aria-hidden="true"
      />
    </div>
    <div class="ml-3 flex-1">
      <h3 class={`text-sm font-medium ${style.textColor}`}>
        {title}
      </h3>
      <div class={`mt-1 text-sm ${style.textColor} opacity-90`}>
        <p>{message}</p>
      </div>
      {showRetry && (
        <div class="mt-3">
          <button
            type="button"
            class={`inline-flex items-center px-3 py-2 text-sm font-medium rounded-md ${style.textColor} hover:opacity-80 focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors duration-200`}
            onclick="window.location.reload()"
          >
            <Icon name="tabler:refresh" class="w-4 h-4 mr-2" />
            {retryText}
          </button>
        </div>
      )}
    </div>
  </div>
</div>
